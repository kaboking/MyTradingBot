name: Freqtrade-Full-Control
on:
  workflow_dispatch:
jobs:
  test-bot:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set up Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - name: Install Dependencies
        run: |
          sudo apt-get update && sudo apt-get install -y build-essential wget
          wget http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz
          tar -xzf ta-lib-0.4.0-src.tar.gz
          cd ta-lib/ && ./configure --prefix=/usr && make && sudo make install
          cd ..
          pip install TA-Lib freqtrade
      - name: Launch With Force Support
        run: |
          freqtrade create-userdir --userdir user_data
          cat <<EOF > user_data/config.json
          {
              "max_open_trades": 3,
              "stake_currency": "USDT",
              "stake_amount": "unlimited",
              "dry_run": true,
              "dry_run_wallet": 1000,
              "exchange": {
                  "name": "gateio",
                  "pair_whitelist": ["BTC/USDT", "ETH/USDT", "SOL/USDT", "DOGE/USDT"]
              },
              "pairlists": [{"method": "StaticPairList"}],
              "telegram": {
                  "enabled": true,
                  "token": "8575558875:AAEK-jcmG5NF1NJGKdq3XHZ4XPcZxjvbtNo",
                  "chat_id": "978554149",
                  "allow_sending_traceback": false,
                  "force_entry_enable": true
              }
          }
          EOF
          # تشغيل البوت
          freqtrade trade --config user_data/config.json --strategy SampleStrategy --userdir user_data --dry-run
